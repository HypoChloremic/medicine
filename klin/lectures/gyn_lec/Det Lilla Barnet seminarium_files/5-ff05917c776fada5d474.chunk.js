(("undefined"!==typeof self?self:this).webpackJsonp=("undefined"!==typeof self?self:this).webpackJsonp||[]).push([[5],{499:function(t,e,o){},500:function(t,e,o){},501:function(t,e,o){},741:function(t,e,o){"use strict";var n=o(9),i=o(18),r=o(22),s=o(210),a=o(35),c=o(55),l=o(118),u=o.n(l),h=o(363),d=o.n(h),b=o(4),p=o(234);function f(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function m(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?f(Object(o),!0).forEach((function(e){v(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):f(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function v(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}var g={components:{MultilineInput:s.a},directives:{t:a.a},props:["body","subject","bodyPlaceholder","showSubjectField"],data:()=>({value:"",invalidUrlMessage:Object(b.a)("Please enter a valid URL."),toolbarInputFocused:!1}),computed:m(m(m({},Object(n.c)("contentPicker",["xContentSourceMenu"])),Object(n.e)(["isMobile","isApp"])),{},{inputId:()=>u()("words"),toolbarId:()=>u()("trixtoolbar"),floatingToolbar(){return!this.isMobile},fixedToolbar(){return this.isMobile&&!this.isApp}}),watch:{body(t){t?this.changeContent(t):this.changeContent("")},subject(t){t?this.changeSubject(t):this.changeSubject("")},toolbarInputFocused(t){t&&this.checkAndToggleFixedToolbar()}},beforeDestroy(){this.$toolbar&&this.$toolbar.remove()},beforeMount(){const t=this.floatingToolbar?"toolbar-floating":"toolbar-fixed",e=document.body;this.$toolbar=Object(p.a)('<trix-toolbar class="'.concat(t,'" id="').concat(this.toolbarId,'"></trix-toolbar>')).appendTo(e)},mounted(){this.$editor=Object(p.a)(this.$refs.trix);const t=this.$editor,e=this.$toolbar,o=e.find("input");e.on("click",t=>{t.stopPropagation()}),d()(()=>{Object(p.a)('<button class="trix-back-button icon-button immaterial-icons" title="Back to formatting menu">arrow_back</button>').prependTo(e.find(".trix-dialog__link-fields")).on("click",()=>{const t=e.find("[data-trix-action=link]")[0],o=new CustomEvent("mousedown",{bubbles:!0,cancelable:!0});t.dispatchEvent(o)})}),o.on("focus",()=>{var e,o,n,i,r;this.toolbarInputFocused=!0,this.value||(o=(n=t.get(0)).editor.getDocument().toString(),e=n.editor.getSelectedRange(),i=o.substring(e[0],e[1]),Object(c.c)(i)?this.value=i:(r="http://"+i,Object(c.c)(r)&&(this.value=r)))}),o.on("invalid",()=>{var t,o;this.toolbarInputFocused=!1,0===(o=this.value).indexOf("http://")||0===o.indexOf("https://")?alert(this.invalidUrlMessage):(t="http://"+o,Object(c.c)(t)?(this.value=t,e.find("input[data-method=setAttribute]").click()):alert(this.invalidUrlMessage))})},methods:{focus(){this.$refs.trix.focus(),this.$nextTick(()=>{this.checkAndToggleFixedToolbar()})},changeContent(t){this.$refs.trix&&this.$refs.trix.editor&&this.$refs.trix.editor.loadHTML(t)},changeSubject(t){this.$refs.subject&&(this.$refs.subject.value=t)},getSubject(){return this.$refs.subject.value},getContent(){return this.$refs.content.value},repositionToolbar(){const t=this.$refs.trix.editor,e=this.$toolbar,o=t.getSelectedRange();if(o[0]===o[1])return void e.hide();const n=t.getClientRectAtPosition(o[0]),i=t.getClientRectAtPosition(o[1])||n,r=n.top,s=Math.min(n.left,i.left),a=i.top,c=Math.max(n.left,i.left),l=Object(p.a)(this.$parent.$el);let u;u=r!==a?l.offset().left+l.width()/2:(s+c)/2;const h={preventDefault:!0,pageX:u,pageY:Math.max(r-10,0)};this.isAndroid?e.show().position({my:"center bottom",at:"center bottom",of:Object(p.a)(document),collision:"fit flip"}):e.show().position({my:"center bottom",at:"center top",of:h,collision:"fit flip"})},onEditorFocus(){this.checkAndToggleFixedToolbar()},onEditorBlur(){this.fixedToolbar&&!this.toolbarInputFocused&&this.$toolbar.hide()},onEditorSelectionChange(){this.floatingToolbar&&this.repositionToolbar()},checkAndToggleFixedToolbar(){this.fixedToolbar&&this.$toolbar.show()},onSubjectChange(t){const e=this.$refs.subject.value;this.$emit("subject-change",e)},onSubjectFocus(){this.fixedToolbar&&this.$toolbar.hide()},onSubjectEnterKeydown(t){13===t.keyCode&&(t.preventDefault(),this.$nextTick(()=>{this.$refs.trix.focus()}))},onEditorFileDrag(t){t.preventDefault()},onEditorChange(t){const e=this.$refs.content.value;this.$emit("change",e)},onAttachmentAdd(t){t.attachment&&t.attachment.remove(),t.originalEvent&&t.originalEvent.attachment&&t.originalEvent.attachment.remove()},onEditorPaste(t){let e=null;const o=t.clipboardData;"function"===typeof o&&(e=o.getData("Text")),d()(()=>{var o,n,i,r,s;return e&&Object(c.c)(e)?(n=(i=(r=t.explicitOriginalTarget||t.originalTarget||t.currentTarget).editor).getDocument().toString(),o=r.editor.getSelectedRange(),s=n.substring(0,o[0]).lastIndexOf(e),i.recordUndoEntry("Auto Link Paste"),i.setSelectedRange([s,o[0]]),i.activateAttribute("href",e),i.setSelectedRange(o)):""})},onKeydown(t){this.isMobile||(this.$emit("enter"),t.preventDefault())}}},O=(o(797),o(7)),j=Object(O.a)(g,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"composer-text-editor"},[t.showSubjectField?o("textarea",{directives:[{name:"t",rawName:"v-t:title",value:"Title",expression:"'Title'",arg:"title"},{name:"t",rawName:"v-t:aria-label",value:"Title",expression:"'Title'",arg:"aria-label"},{name:"t",rawName:"v-t:placeholder",value:"Title",expression:"'Title'",arg:"placeholder"}],ref:"subject",staticClass:"subject",attrs:{dir:"auto",tabindex:t.xContentSourceMenu?-1:0},domProps:{value:t.subject},on:{input:t.onSubjectChange,focus:t.onSubjectFocus,keydown:t.onSubjectEnterKeydown}}):t._e(),t._v(" "),o("div",{staticClass:"body"},[o("input",{ref:"content",staticClass:"content",attrs:{id:t.inputId,type:"hidden"},domProps:{value:t.body},on:{keydown:function(e){return e.preventDefault(),t.onKeydown(e)}}}),t._v(" "),o("trix-editor",{ref:"trix",attrs:{dir:"auto",toolbar:t.toolbarId,input:t.inputId,placeholder:t.bodyPlaceholder,tabindex:t.xContentSourceMenu?-1:0},on:{"trix-focus":t.onEditorFocus,"trix-blur":t.onEditorBlur,"trix-selection-change":t.onEditorSelectionChange,"trix-file-accept":t.onEditorFileDrag,"trix-change":t.onEditorChange,"trix-attachment-add":t.onAttachmentAdd,paste:t.onEditorPaste,keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")||e.ctrlKey||e.shiftKey||e.altKey||e.metaKey?null:t.onKeydown(e)}}})],1)])}),[],!1,null,null,null).exports,w=o(45),y=o(196),C=o(74);function x(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function k(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?x(Object(o),!0).forEach((function(e){S(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):x(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function S(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}var P={components:{BaseIcon:r.a},directives:{t:a.a},data:()=>({width:320,Source:y.a}),computed:k(k(k({},Object(n.e)(["isMobile"])),Object(n.c)("browser",["windowWidth"])),{},{contentSourceCount(){return this.width?Math.floor(this.width/40):5}}),watch:{windowWidth(t){this.width=null,this.$nextTick(()=>{this.width=this.$refs.wrapper.offsetWidth})}},mounted(){this.width=this.$refs.wrapper.offsetWidth},methods:k(k({},Object(n.b)("contentPicker",["showContentSourceMenu","pickContentSource"])),{},{openSearchMenu(t){if(Object(C.a)("contentPicker",1)){var e={left:t.clientX,top:t.clientY};this.showContentSourceMenu({position:e,search:!0}),this.$nextTick(()=>{document.querySelector("input.search-input").focus()})}else this.getContent(y.a.WebBrowser)},getContent(t){Object(w.a)("Content Menu","Selected Source","Wish "+t),this.pickContentSource({source:t})},getContentIfSupported(t){this.isMobile||this.getContent(t)},chooseContentSource(t){var e;e={left:t.clientX,top:t.clientY},this.showContentSourceMenu({position:e})}})},E=(o(798),Object(O.a)(P,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{ref:"wrapper",staticClass:"surface-attachment-picker"},[o("div",{staticClass:"pick-content"},[t.contentSourceCount>1?o("button",{directives:[{name:"t",rawName:"v-t:title",value:"Upload",expression:"'Upload'",arg:"title"}],staticClass:"icon-button",on:{click:function(e){return t.getContentIfSupported(t.Source.FileBrowser)}}},[o("label",{attrs:{for:"content-hidden-file-input"}},[o("base-icon",{attrs:{name:"upload"}})],1)]):t._e(),t._v(" "),t.contentSourceCount>2?o("button",{directives:[{name:"t",rawName:"v-t:title",value:"Link",expression:"'Link'",arg:"title"}],staticClass:"icon-button",on:{click:function(e){return t.getContent(t.Source.LinkInput)}}},[o("base-icon",{attrs:{name:"link"}})],1):t._e(),t._v(" "),t.contentSourceCount>3?o("button",{directives:[{name:"t",rawName:"v-t:title",value:"Google",expression:"'Google'",arg:"title"}],staticClass:"icon-button",on:{click:t.openSearchMenu}},[o("base-icon",{attrs:{name:"search_web"}})],1):t._e(),t._v(" "),t.contentSourceCount>4?o("button",{directives:[{name:"t",rawName:"v-t:title",value:"Snap",expression:"'Snap'",arg:"title"}],staticClass:"icon-button",on:{click:function(e){return t.getContentIfSupported(t.Source.PhotoBooth)}}},[o("label",{attrs:{for:"content-hidden-image-input"}},[o("base-icon",{attrs:{name:"camera"}})],1)]):t._e(),t._v(" "),t.contentSourceCount>1?o("button",{directives:[{name:"t",rawName:"v-t:title",value:"More",expression:"'More'",arg:"title"}],staticClass:"icon-button",on:{click:t.chooseContentSource}},[o("base-icon",{attrs:{name:"more_horiz"}})],1):t._e(),t._v(" "),t.contentSourceCount<=1?o("button",{directives:[{name:"t",rawName:"v-t:title",value:"Add attachment",expression:"'Add attachment'",arg:"title"}],staticClass:"icon-button",on:{click:t.chooseContentSource}},[o("base-icon",{attrs:{name:"attachment"}})],1):t._e()])])}),[],!1,null,"9f1f88b2",null).exports),$=o(369),_=o(54);function T(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function A(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?T(Object(o),!0).forEach((function(e){B(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):T(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function B(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}var M={components:{BaseIcon:r.a,SurfaceComposerTextEditor:j,SurfaceAttachmentPicker:E,SurfaceAttachmentPreview:$.a},directives:{t:a.a},mixins:[i.b],data:()=>({originalAttributes:null,attachmentWidth:128,attachmentHeight:72,editorHeight:0}),computed:A(A(A(A({},Object(n.e)(["wishListMounted"])),Object(n.c)("post",["chatAttachment","postBeingEdited"])),Object(n.c)(["isBackchannel"])),{},{bodyPlaceholder(){return this.isBackchannel?this.__("Say something ..."):this.__("Write something ...")},inputId:()=>u()("words"),toolbarId:()=>u()("trixtoolbar"),button(){return!this.postBeingEdited||Object(_.j)(this.postBeingEdited)?"send":"save"},attachment(){return this.postBeingEdited&&this.postBeingEdited.attachment||this.chatAttachment},body(){return this.postBeingEdited?this.postBeingEdited.body:null},subject(){return this.postBeingEdited?this.postBeingEdited.subject:null},showRemoveIcon(){return!!this.attachment}}),watch:{postBeingEdited(t){t?Object(_.j)(t)||(null===this.originalAttributes&&(this.originalAttributes=A({},t)),this.focusOnComposer()):this.clearContent()},wishListMounted(t){t&&this.$nextTick(()=>this.updateEditorHeight())}},beforeDestroy(){this._mutationObserver&&this._mutationObserver.disconnect()},mounted(){this.postBeingEdited&&(this.originalAttributes=A({},this.postBeingEdited)),this.focusOnComposer();this._mutationObserver=new MutationObserver(()=>{this.updateEditorHeight()}),this._mutationObserver.observe(this.$el,{subtree:!0,childList:!0}),this.$nextTick(()=>this.updateEditorHeight())},methods:A(A(A({},Object(n.b)(["resizeEditor"])),Object(n.b)("post",["savePost","startNewPost","stopEditingPost","removePostAttachment"])),{},{clearContent(){!this.isBackchannel&&this.$refs.editor.changeSubject(""),this.$refs.editor.changeContent(""),this.removeAttachment()},removeAttachment(){this.removePostAttachment()},focusOnComposer(){this.$refs.editor.focus()},cancel(){this.postBeingEdited&&!Object(_.j)(this.postBeingEdited)&&Object(_.k)(this.originalAttributes)&&this.savePost({attributes:this.originalAttributes}),this.stopEditingPost(),this.clearContent(),this.$nextTick(()=>{this.isBackchannel&&(this.focusOnComposer(),this.clearContent())})},sendOrSave(){this.focusOnComposer();const t=this.attachment,e=this.isBackchannel?"":this.$refs.editor.getSubject(),o=this.$refs.editor.getContent();if(""!==e||""!==o||t&&""!==t){const n=A(A({},this.postBeingEdited),{},{subject:e,body:o,attachment:t});"save"===this.button&&(this.originalAttributes=null),this.savePost({attributes:n}),this.clearContent(),this.$nextTick(()=>{this.isBackchannel&&(this.clearContent(),this.focusOnComposer())}),Object(w.a)("Posts","add","Chat Post Button")}else this.clearContent(),this.$nextTick(()=>{this.isBackchannel&&this.clearContent()})},updateEditorHeight(){const t=this.$el.offsetHeight;t!==this.editorHeight&&(this.editorHeight=t,this.resizeEditor({height:t}))}})},D=(o(799),Object(O.a)(M,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"surface-composer"},[o("div",{staticClass:"surface-composer-text-editor"},[o("surface-composer-text-editor",{ref:"editor",attrs:{"show-subject-field":!t.isBackchannel,"body-placeholder":t.bodyPlaceholder,subject:t.subject,body:t.body},on:{enter:t.sendOrSave}})],1),t._v(" "),t.attachment?o("div",{staticClass:"composer-attachment-preview-wrapper"},[o("div",{staticClass:"composer-attachment-preview"},[t.attachment?o("surface-attachment-preview",{staticClass:"composer-attachment",attrs:{url:t.attachment,width:t.attachmentWidth,height:t.attachmentHeight,actionable:!1,autocolor:!1}}):t._e(),t._v(" "),t.showRemoveIcon?o("div",{directives:[{name:"t",rawName:"v-t:title",value:"Remove attachment",expression:"'Remove attachment'",arg:"title"}],key:"remove",staticClass:"attachment-controls remove-attachment",on:{click:t.removeAttachment}},[o("base-icon",{attrs:{name:"close"}})],1):t._e()],1)]):t._e(),t._v(" "),o("div",{staticClass:"composer-attachment-picker-wrapper"},[o("button",{directives:[{name:"t",rawName:"v-t"}],staticClass:"caption-text-button narrow-button",on:{click:t.cancel}},[t._v("Cancel")]),t._v(" "),t.attachment?t._e():o("surface-attachment-picker"),t._v(" "),"send"===t.button?o("button",{directives:[{name:"t",rawName:"v-t"}],key:"button-send",staticClass:"flat-button narrow-button",on:{click:t.sendOrSave}},[t._v("\n      Post\n    ")]):o("button",{directives:[{name:"t",rawName:"v-t"}],key:"button-save",staticClass:"flat-button narrow-button",on:{click:t.sendOrSave}},[t._v("Save")])],1)])}),[],!1,null,null,null));e.a=D.exports},797:function(t,e,o){"use strict";var n=o(499);o.n(n).a},798:function(t,e,o){"use strict";var n=o(500);o.n(n).a},799:function(t,e,o){"use strict";var n=o(501);o.n(n).a}}]);
//# sourceMappingURL=5-ff05917c776fada5d474.chunk.js.map