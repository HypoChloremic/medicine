(("undefined"!==typeof self?self:this).webpackJsonp=("undefined"!==typeof self?self:this).webpackJsonp||[]).push([[84],{1017:function(t,e,i){},1018:function(t,e,i){},1019:function(t,e,i){},1020:function(t,e,i){},1084:function(t,e,i){"use strict";var s=i(1017);i.n(s).a},1085:function(t,e,i){"use strict";var s=i(1018);i.n(s).a},1086:function(t,e,i){"use strict";var s=i(1019);i.n(s).a},1087:function(t,e,i){"use strict";var s=i(1020);i.n(s).a},1116:function(t,e,i){"use strict";i.r(e);var s=i(3),n=i(12),o=i(405),r=i(9),c=i(18),a=i(293),d=i(394),l={data:()=>({$_sectionsOrderSortMixin_initialized:!1}),updated(){this.$_sectionsOrderSortMixin_initialized?this.$_sectionsOrderSortMixin_makeSortable():this.$_sectionsOrderSortMixin_destroySortable()},beforeDestroy(){this.$_sectionsOrderSortMixin_destroySortable()},methods:{initializeSectionsOrderSort(){this.$_sectionsOrderSortMixin_initialized=!0},$_sectionsOrderSortMixin_markItemAsTransiting(t){t.addClass("noclick in-transit")},$_sectionsOrderSortMixin_unmarkItemAsTransiting(t){t.removeClass("noclick in-transit")},$_sectionsOrderSortMixin_makeSortable(){let t=Object(d.a)(this.$el);t.sortable("instance")||t.sortable({axis:"x",cursor:"move",handle:".surface-section-title",items:"> .surface-section.section-sortable",scrollSensitivity:48,cancel:"[contenteditable], .ui-resizable-handle, object, embed, input, button, textarea",start:(t,e)=>{null==e.item.data("section-id")&&this.update(),this.$_sectionsOrderSortMixin_markItemAsTransiting(e.item)},stop:(t,e)=>{this.$_sectionsOrderSortMixin_unmarkItemAsTransiting(e.item)},update:(t,e)=>{this.sortedSection(a.a.getNewIndex(e.item))}})},$_sectionsOrderSortMixin_destroySortable:function(){let t=Object(d.a)(this.$el).off(".sort").sortable("instance");t&&t.destroy()}}},u=i(22),h=i(210),p=i(270);function b(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function S(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?b(Object(i),!0).forEach((function(e){m(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):b(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function m(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var f={components:{MultilineInput:h.a,BaseIcon:u.a},mixins:[p.a,c.b],props:["section","sectionBeingEditedId"],data:()=>({maxLength:512}),computed:S(S(S(S({},Object(r.e)(["isWallOnboardingFlow","isIOS"])),Object(r.c)("section",{wallSections:"sections"})),Object(r.c)({isEditable:"canIModerate",canIEdit:"canIEdit"})),{},{sectionTitle(){return this.section.title},canEdit(){return this.canIEdit},isBeingEdited(){return this.sectionBeingEditedId&&this.sectionBeingEditedId===this.section.id&&!this.isWallOnboardingFlow},wallSectionsLength(){return this.wallSections.length},isEmptyState(){return this.isBeingEdited&&1===this.wallSectionsLength},titlePlaceholder(){return this.isEmptyState?this.__("Name your first column"):this.__("Name your column")}}),watch:{isBeingEdited(t){t&&this.$nextTick(()=>{this.$refs.title.focus()})}},mounted(){this.isBeingEdited&&this.$nextTick(()=>{this.$refs.title.focus()})},methods:S(S(S({},Object(r.b)("section",["changeSectionTitle","stopEditingSection","startEditingSection","showSectionActionMenu"])),Object(r.b)("snackbars",["setSnackbar"])),{},{saveTitle(){const t=this.$refs.title.$el.value.replace(/\n|\r/g,"");if(t.length>0)this.changeSectionTitle({sectionId:this.section.id,title:t});else{const t=this.__("Column title cannot be empty.");this.setSnackbar({message:t})}},tryStartEditing(){this.canEdit&&!this.isBeingEdited&&this.startEditingSection({sectionId:this.section.id})},deleteSection(){this.$emit("delete")},onOutsideClick(){if(!this.isBeingEdited)return;const t=this.$refs.title.$el.value.replace(/\n|\r/g,"");t.length>0?this.changeSectionTitle({sectionId:this.section.id,title:t}):this.stopEditingSection()}})},O=(i(1084),i(7)),g=Object(O.a)(f,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("header",{staticClass:"surface-section-title section-title",attrs:{"data-view-mode":t.isBeingEdited?"edit":"show"},on:{dblclick:t.tryStartEditing}},[i("div",{staticClass:"section-frame"},[i("div",{staticClass:"real-section"},[t.isBeingEdited?t._e():i("hgroup",[i("h2",{staticClass:"title",attrs:{dir:"auto"}},[t._v(t._s(t.sectionTitle))])]),t._v(" "),t.isBeingEdited?i("hgroup",{staticClass:"is-editing"},[i("multiline-input",{ref:"title",staticClass:"title",attrs:{dir:"auto",value:t.sectionTitle,maxlength:t.maxLength,placeholder:t.titlePlaceholder,required:""},on:{enter:t.saveTitle,escape:t.stopEditingSection}})],1):t._e()]),t._v(" "),t.isBeingEdited?i("div",{staticClass:"button-list"},[t.isEmptyState?t._e():i("button",{directives:[{name:"t",rawName:"v-t:title",value:"Cancel",expression:"'Cancel'",arg:"title"},{name:"t",rawName:"v-t"}],staticClass:"button text-button",on:{click:t.stopEditingSection}},[t._v("\n        Cancel\n      ")]),t._v(" "),i("button",{directives:[{name:"t",rawName:"v-t:title",value:"Done",expression:"'Done'",arg:"title"},{name:"t",rawName:"v-t"}],staticClass:"button text-button",on:{click:t.saveTitle}},[t._v("Save")])]):t._e(),t._v(" "),t.isEditable&&!t.isBeingEdited?i("button",{directives:[{name:"t",rawName:"v-t:title",value:"Column actions",expression:"'Column actions'",arg:"title"}],staticClass:"surface-section-actions icon-button",on:{click:function(e){return t.showSectionActionMenu({sectionId:t.section.id})}}},[i("base-icon",{attrs:{name:"more_vert"}})],1):t._e()])])}),[],!1,null,null,null).exports,v=i(404),_=i(27),w=i(74),y=i(192);var j={data:()=>({$_sectionSortMixin_initialized:!1,$_sectionSortMixin_savePostHandler:null}),beforeDestroy(){this.$_sectionSortMixin_destroySortable()},methods:{initializeSectionSort(t){this.$_sectionSortMixin_makeSortable(),this.$_sectionSortMixin_savePostHandler=t,t||Object(_.c)("Using SectionSortMixin without declaring a handler function to save post."),this.$_sectionSortMixin_initialized=!0},destroySectionSort(){this.$_sectionSortMixin_destroySortable(),this.$_sectionSortMixin_savePostHandler=null,this.$_sectionSortMixin_initialized=!1},$_sectionSortMixin_clipItems(t,e,i){let s,n,o=i.height(),r=i.width();if(o>144){let t=e.offsetY+(e.originalEvent.target.getBoundingClientRect().top-i[0].getBoundingClientRect().top);if(t>144){o-t<144?(n=o-144,s=o):(n=t-72,s=n+144),i.data("clipTop",n)}else n=0,s=144;i.css("clip","rect("+n+"px, "+r+"px, "+s+"px, 0)")}t.addClass("ui-sortable-clipped")},$_sectionSortMixin_unclipItems(t,e,i){let s=document.getElementById("wall-container"),n=i[0].offsetTop;t.removeClass("ui-sortable-clipped");let o=null!=i.data("clipTop")?i.data("clipTop"):0,r=null!=i.data("scrollTop")?i.data("scrollTop"):0,c=i[0].offsetTop-n;s.scrollTop=r+c+o,i.removeData("clipTop"),i.removeData("scrollTop")},$_sectionSortMixin_saveScrollPosition(t,e,i){let s=document.getElementById("wall-container");i.data("scrollTop",s.scrollTop)},$_sectionSortMixin_markItemAsTransiting(t){t.addClass("noclick in-transit")},$_sectionSortMixin_unmarkItemAsTransiting(t){t.removeClass("noclick in-transit")},$_sectionSortMixin_savePost(t){let e=t.sectionId,i=t.sortIndex,s=t.postCid,n=t.previousCid,o=t.nextCid;this.$_sectionSortMixin_savePostHandler?(Object(w.a)("wishOrderArray")&&this.$_sectionSortMixin_savePostHandler({sectionId:e,postCid:s,previousCid:n,nextCid:o}),Object(w.a)("wishOrderArray")||this.$_sectionSortMixin_savePostHandler({sectionId:e,postCid:s,sortIndex:i})):Object(_.a)(new Error("No handler to save post for SectionSortMixin."))},$_sectionSortMixin_makeSortable(){let t=Object(d.a)(this.$el).find(".section-posts");t.sortable("instance")||t.sortable({connectWith:".surface-section .section-posts",cursor:"move",items:"> .wish-editable:not(#wish-new)",scrollSensitivity:48,cancel:"[contenteditable], .ui-resizable-handle, object, embed, input, button, textarea, select, option",start:(e,i)=>{t.addClass("ui-sortable-sorting"),this.$_sectionSortMixin_clipItems(t,e,i.item),t.sortable("refreshPositions"),this.$_sectionSortMixin_markItemAsTransiting(i.item)},beforeStop:(e,i)=>{this.$_sectionSortMixin_saveScrollPosition(t,e,i.item)},stop:(e,i)=>{t.removeClass("ui-sortable-sorting"),"stream"!==this.$_sectionSortMixin_format&&"shelf"!==this.$_sectionSortMixin_format||this.$_sectionSortMixin_unclipItems(t,e,i.item),this.$_sectionSortMixin_unmarkItemAsTransiting(i.item)},over:(t,e)=>{e.item.data("newSectionId",this.currentSectionId)},change:(t,e)=>{e.item.removeData("prevWishId nextWishId previousCid nextCid");let i=e.placeholder;e.item.data({prevWishId:i.prev(".wish").attr("id"),nextWishId:i.next(".wish").attr("id"),previousCid:i.next(".wish").data("postCid"),nextCid:i.prev(".wish").data("postCid")})},remove:(e,i)=>{i.placeholder.remove(),t.sortable("cancel")},update:(t,e)=>{var i;e.item.data("newSectionId")===this.currentSectionId&&((i={}).sectionId=this.currentSectionId,i.prevId=e.item.data("prevWishId"),i.nextId=e.item.data("nextWishId"),i.prevId||(i.prevId=null),i.nextId||(i.nextId=null),Object(w.a)("wishOrderArray")&&this.$_sectionSortMixin_savePost({sectionId:this.currentSectionId,postCid:e.item.data("postCid"),previousCid:e.item.data("previousCid"),nextCid:e.item.data("nextCid")}),Object(w.a)("wishOrderArray")||Object(y.a)(e.item,i),e.item.removeData("newSectionId prevWishId nextWishId previousCid nextCid"))}})},$_sectionSortMixin_destroySortable(){let t=Object(d.a)(this.$el).off(".sort").sortable("instance");t&&t.destroy()}}},x=i(349);function I(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function P(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?I(Object(i),!0).forEach((function(e){C(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):I(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function C(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var E={components:{BaseIcon:u.a,SurfacePost:v.a,SurfaceSectionTitle:g},mixins:[c.b,j],props:{section:{type:Object,default:()=>({})}},computed:P(P(P(P(P(P(P({},Object(r.e)(["inlinePostEdit"])),Object(r.c)("post",["postBeingEditedCid","postEntitiesByCid","postCidsBySection","postOrder"])),Object(r.e)("section",["sectionEntities","sectionBeingEditedId"])),Object(r.c)("section",{wallSections:"sections"})),Object(r.c)({canReorder:"canIModerate"})),Object(r.c)(["canIModerate","newPostLocation","isPostable"])),{},{sectionDomId(){return Object(x.b)(this.currentSectionId)},wallSectionsLength(){return this.wallSections.length},currentSectionId(){return 0===this.wallSectionsLength?this.sectionBeingEditedId:this.section.id},currentSection(){return this.sectionEntities[this.currentSectionId]},sortIndex(){return this.currentSection.sort_index},sectionColor(){return this.currentSection.color},postCidsInCurrentSection(){return this.postCidsBySection[this.currentSectionId]||[]},sortedSectionPosts(){const t=this.postCidsInCurrentSection.map(t=>this.postEntitiesByCid[t]);if(Object(w.a)("wishOrderArray")&&(!this.postOrder||0===this.postOrder.length))return[];if(!this.inlinePostEdit){const e=t.filter(t=>t.id||!!t.body||!!t.subject||!!t.attachment);return Object(w.a)("wishOrderArray")?Object(y.g)(e,this.postOrder):Object(y.h)(e)}return Object(w.a)("wishOrderArray")||Object(w.a)("wishOrderArray")||Object(w.a)("wishOrderArray")||Object(w.a)("wishOrderArray")||Object(w.a)("wishOrderArray")||Object(w.a)("wishOrderArray")?Object(y.g)(t,this.postOrder):Object(y.h)(t)},canAddPost(){return this.isPostable&&(!this.sectionBeingEditedId||this.section.id!==this.sectionBeingEditedId)},shouldShowButtonAtTop(){return this.canAddPost&&"top"===this.newPostLocation},shouldShowButtonAtBottom(){return this.canAddPost&&"bottom"===this.newPostLocation}}),mounted(){this.isPostable&&(Object(w.a)("wishOrderArray")&&this.initializeSectionSort(t=>{let e=t.postCid,i=t.sectionId,s=t.previousCid,n=t.nextCid;this.sortedPost({postCid:e,sectionId:i,previousCid:s,nextCid:n})}),Object(w.a)("wishOrderArray")||this.initializeSectionSort(t=>{let e=t.postCid,i=t.sortIndex,s=t.sectionId;this.sortedPost({postCid:e,sortIndex:i,sectionId:s})}))},methods:P(P(P({},Object(r.b)("post",["sortedPost"])),Object(r.b)("section",["deleteSection"])),{},{confirmDeleteSection(){window.confirm(this.__("Are you sure you want to delete this column and all its posts? This cannot be undone!"))&&this.deleteSection({sectionId:this.currentSectionId})},startNewPost(){this.$store.dispatch("post/startNewPost",{attributes:{wall_section_id:this.section.id}})}})};i(1085);function $(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function M(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?$(Object(i),!0).forEach((function(e){A(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):$(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function A(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var B={components:{SurfaceSection:Object(O.a)(E,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",{class:["surface-section",{"section-sortable":t.canReorder}],attrs:{id:t.sectionDomId,"data-rank":t.sortIndex,"data-section-id":t.currentSectionId,"data-color":t.sectionColor}},[i("surface-section-title",{attrs:{section:t.currentSection,"section-being-edited-id":t.sectionBeingEditedId},on:{delete:t.confirmDeleteSection}}),t._v(" "),t.shouldShowButtonAtTop?i("button",{directives:[{name:"t",rawName:"v-t:title",value:"Add post to this column",expression:"'Add post to this column'",arg:"title"}],staticClass:"flat-button muted-button add-post",on:{click:function(e){return e.preventDefault(),t.startNewPost(e)}}},[i("base-icon",{staticClass:"add-icon",attrs:{name:"add"}})],1):t._e(),t._v(" "),i("div",{ref:"postsList",staticClass:"section-posts",attrs:{"data-section-id":t.currentSectionId}},t._l(t.sortedSectionPosts,(function(e,s){return i("surface-post",{key:e.cid,attrs:{index:s,post:e,edit:t.inlinePostEdit,"is-last":s===t.sortedSectionPosts.length-1}})})),1),t._v(" "),t.shouldShowButtonAtBottom?i("div",{directives:[{name:"t",rawName:"v-t:title",value:"Add post to this column",expression:"'Add post to this column'",arg:"title"}],staticClass:"add-post",on:{click:function(e){return e.preventDefault(),t.startNewPost(e)}}},[i("button",{staticClass:"flat-button muted-button"},[i("base-icon",{staticClass:"add-icon",attrs:{name:"add"}})],1)]):t._e()],1)}),[],!1,null,null,null).exports},mixins:[c.b,l],computed:M(M(M(M(M(M({},Object(r.e)(["wall","isIOS"])),Object(r.e)("section",["sectionsFetched","sectionBeingEditedId"])),Object(r.c)("section",["sortedSections"])),Object(r.c)(["canIModerate","isAPanelVisible"])),Object(r.c)("browser",["windowHeight"])),{},{isEmptyState(){return 0===this.sortedSections.length||1===this.sortedSections.length&&!!this.sectionBeingEditedId&&this.sectionBeingEditedId===this.sortedSections[0].id},canAddSection(){return this.canIModerate&&!this.isEmptyState},isNewSectionBeingAdded(){return String(this.sectionBeingEditedId).startsWith("new_")}}),watch:{isAPanelVisible:"addSectionIfNone",windowHeight:"setMaxHeight"},beforeMount(){this.addSectionIfNone()},mounted(){this.initializeSectionsOrderSort(),this.setMaxHeight()},updated(){this.addSectionIfNone()},methods:M(M({},Object(r.b)("section",["sortedSection","startNewSection","startWithNoSections"])),{},{addSectionIfNone(){0===this.sortedSections.length&&this.sectionsFetched&&!this.isAPanelVisible&&this.startWithNoSections()},newSection:()=>({sort_index:a.a.getBottomSortIndex()}),addSection(){this.startNewSection({section:this.newSection()})},setMaxHeight(){if(this.isIOS&&navigator.userAgent.toLowerCase().includes("14_4")){const t=document.getElementById("wish-list").offsetHeight;this.$el.style="max-height: ".concat(t,"px;")}}})},T=(i(1086),Object(O.a)(B,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"surface-sections"},[t._l(t.sortedSections,(function(t){return i("surface-section",{key:t.id,attrs:{id:"section-"+t.id,section:t}})})),t._v(" "),i("div",{staticClass:"add-section-frame"},[t.canAddSection&&!t.isNewSectionBeingAdded?i("button",{directives:[{name:"t",rawName:"v-t"}],staticClass:"flat-button muted-button add-section",on:{click:t.addSection}},[t._v("\n      Add column\n    ")]):t._e()])],2)}),[],!1,null,null,null).exports),k=i(402),N=i(403),D=function(t,e,i,s){var n,o=arguments.length,r=o<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(t,e,i,s);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(o<3?n(r):o>3?n(e,i,r):n(e,i))||r);return o>3&&r&&Object.defineProperty(e,i,r),r},H=function(t,e){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(t,e)};const W=Object(n.d)("post"),z=Object(n.d)("section");let L=class extends s.e{mounted(){this.$nextTick(()=>this.toggleNewPostHandlers(this.isPostable))}beforeDestroy(){this.disableNewPostHandlers()}enableNewPostHandlers(){this.enablePasteToPost(),this.enableDropToPost(this.$el)}disableNewPostHandlers(){this.disablePasteToPost(),this.disableDropToPost(this.$el)}toggleNewPostHandlers(t){t?this.enableNewPostHandlers():this.disableNewPostHandlers()}scrollWallToSection(t){const e=this.postEntitiesByCid[t].wall_section_id;Object(x.a)(e)}};D([n.c,H("design:type",Object)],L.prototype,"xHeader",void 0),D([W.Getter,H("design:type",Object)],L.prototype,"newestPostCid",void 0),D([W.Getter,H("design:type",Object)],L.prototype,"postEntitiesByCid",void 0),D([z.Action,H("design:type",Object)],L.prototype,"startEditingSection",void 0),D([z.Action,H("design:type",Object)],L.prototype,"deleteSection",void 0),D([n.b,H("design:type",Object)],L.prototype,"isPostable",void 0),D([Object(s.f)("isPostable"),H("design:type",Function),H("design:paramtypes",[Object]),H("design:returntype",void 0)],L.prototype,"toggleNewPostHandlers",null),D([Object(s.f)("newestPostCid"),H("design:type",Function),H("design:paramtypes",[Object]),H("design:returntype",void 0)],L.prototype,"scrollWallToSection",null),L=D([Object(s.a)({components:{SurfaceHeader:o.a,SurfaceSections:T},mixins:[k.a,N.a]})],L);var R=L,F=(i(1087),Object(O.a)(R,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"wall-container"}},[this.xHeader?e("surface-header"):this._e(),this._v(" "),e("div",{ref:"wishList",staticClass:"wish-list",attrs:{id:"wish-list"}},[e("surface-sections")],1),this._v(" "),e("div",{staticClass:"wish-sizer"}),this._v(" "),e("div",{staticClass:"gutter-sizer"})],1)}),[],!1,null,null,null));e.default=F.exports}}]);
//# sourceMappingURL=84-a85f832b3d03c7cf68a9.chunk.js.map